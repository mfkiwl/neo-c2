##########################################
# installed directories
##########################################
prefix=@prefix@ exec_prefix=@exec_prefix@
bindir=@bindir@
datadir=@datadir@
mandir=@mandir@
sharedstatedir=@sharedstatedir@
sysconfdir=@sysconfdir@/neo-c
includedir=@includedir@/neo-c
datarootdir=@datarootdir@/neo-c
docdir=@datadir@/doc
libdir=@libdir@


#########################################
# environmnet variables
##########################################
CC=@CC@
NCC=@NCC@
INSTALL=@INSTALL@
CFLAGS=@CFLAGS@
NCFLAGS=@NCFLAGS@
LIBS=@LIBS@
OS=@OS@
DESTDIR=@DESTDIR@

#########################################
# main
##########################################
all: vico

vico: configure Makefile config.h main.o main.c 01init.o 01init.c 02base.o 02base.c 03insert_mode.o 03insert_mode.c 04word.c 04word.o 05undo.c 05undo.o 06file.o 07yank.o 08visual.o 09search.o
	$(CC) -o vico main.o 01init.o 02base.o 03insert_mode.o 04word.o 05undo.o 06file.o 07yank.o 08visual.o 09search.o -L/opt/local/lib $(CFLAGS) $(LIBS) $(NCFLAGS)

main.o: configure Makefile config.h main.c common.h
	come main.c $(CFLAGS) $(NCFLAGS)
	$(CC) -c -o main.o main.c.ll

01init.o: configure Makefile config.h 01init.c common.h
	come 01init.c $(CFLAGS) $(NCFLAGS)
	$(CC) -c -o 01init.o 01init.c.ll

02base.o: configure Makefile config.h 02base.c common.h
	come 02base.c $(CFLAGS) $(NCFLAGS)
	$(CC) -c -o 02base.o 02base.c.ll

03insert_mode.o: configure Makefile config.h 03insert_mode.c common.h
	come 03insert_mode.c $(CFLAGS) $(NCFLAGS)
	$(CC) -c -o 03insert_mode.o 03insert_mode.c.ll

04word.o: configure Makefile config.h 04word.c common.h
	come 04word.c $(CFLAGS) $(NCFLAGS)
	$(CC) -c -o 04word.o 04word.c.ll

05undo.o: configure Makefile config.h 05undo.c common.h
	come 05undo.c $(CFLAGS) $(NCFLAGS)
	$(CC) -c -o 05undo.o 05undo.c.ll

06file.o: configure Makefile config.h 06file.c common.h
	come 06file.c $(CFLAGS) $(NCFLAGS)
	$(CC) -c -o 06file.o 06file.c.ll

07yank.o: configure Makefile config.h 07yank.c common.h
	come 07yank.c $(CFLAGS) $(NCFLAGS)
	$(CC) -c -o 07yank.o 07yank.c.ll

08visual.o: configure Makefile config.h 08visual.c common.h
	come 08visual.c $(CFLAGS) $(NCFLAGS)
	$(CC) -c -o 08visual.o 08visual.c.ll

09search.o: configure Makefile config.h 09search.c common.h
	come 09search.c $(CFLAGS) $(NCFLAGS)
	$(CC) -c -o 09search.o 09search.c.ll

#########################################
# install
#########################################
install:
	mkdir -p "$(DESTDIR)/bin"
	$(INSTALL) -m 755 ./vico "$(DESTDIR)/bin"

#########################################
# uninstall
#########################################
uninstall:
	rm -f "$(DESTDIR)"/bin/vico

#########################################
# permission
#########################################
permission:
	chmod 644 *
	chmod 755 .git man configure
	chmod 644 *.c
	chmod 644 *.h

#########################################
# clean
#########################################
clean:
	rm -fR *.ll *.bc *.c.tmp *.out *.o valgrind.txt *.i aaa AAA BBB bbb
	rm -fR vico

distclean: clean
	rm -fR  config.h Makefile autom4te.cache 

test:
	rm -f valgrind.txt
	valgrind ./vico a.txt 2> aaa

